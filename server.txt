FROM centos as base

# base：基本命令和配置yum源
RUN mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup \
	&& curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo \
	&& yum clean all && yum makecache \
	&& yum -y install epel-release sudo vim

# nodejs：安装nodejs和cnpm
From base as nodejs
RUN curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash - \
	&& yum -y install nodejs \
	&& npm install -g cnpm --registry=https://registry.npm.taobao.org


# webServer：使用npm安装相关依赖
From nodejs as webServer
WORKDIR /home/myapp
# RUN npm install express-generator -g \
# 	&& cd .. && express --view=ejs -f myapp \
# 	&& cd myapp && npm --save install
# CMD ["npm", "start"]